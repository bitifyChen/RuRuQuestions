import{r as x,e as R,c as l,o as n,a as r,h,i as y,t as b,b as m,u as w,j as k,v as C,w as S,k as V,F,l as T,n as j}from"./index-DGx74SFh.js";import{T as $,r as D,u as _}from"./xlsx-DUbICNJn.js";const O={class:"space-y-6"},M={class:"flex space-x-4"},U={class:"p-6 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 shadow-lg flex-1 transition-transform hover:scale-[1.01]"},z={key:0,class:"mt-4 text-gray-700 text-center text-sm tracking-wide select-text"},L={class:"font-semibold"},W={key:0,class:"p-6 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 shadow-lg flex-1 flex items-center justify-center hover:scale-[1.01]"},q={class:"text-center space-y-2"},G={class:"flex items-center justify-center space-x-2 text-red-500"},H={class:"text-5xl font-extrabold text-red-700"},J={key:0,class:""},K={key:1,class:"overflow-auto border border-white/40 rounded-2xl bg-white/30 backdrop-blur-md shadow-lg"},P={class:"min-w-full border-collapse text-gray-800"},Q=["title"],X={key:0,class:"border border-white/20 px-4 py-2 text-red-600 font-black"},Y={key:1,class:"border border-white/20 px-4 py-2"},re={__name:"index",setup(Z){const v=x(""),u=x([]),g=x({}),d=x(!1),N=R(()=>u.value.map((t,e)=>({originalIndex:e,displayIndex:e+2,...t,error:g.value[e]||""})).filter(t=>!d.value||t.error));function E(t){t["!merges"]&&t["!merges"].forEach(({s:e,e:o})=>{var a;const s=_.encode_cell(e),i=((a=t[s])==null?void 0:a.v)??"";for(let f=e.r;f<=o.r;++f)for(let c=e.c;c<=o.c;++c){const p=_.encode_cell({r:f,c});t[p]||(t[p]={t:"s",v:i})}})}function A(t){if(!t||t.toString().trim()==="")return"五通號欄位不可為空";const e=t.toString(),o=e.indexOf("~");return o===-1?"必須包含「~」字元":o!==18?"「~」前必須符合18個字":e.length-o-1!==4?"「~」後必須符合4個字":""}function B(t){const e={};return t.forEach((o,s)=>{const i=o.五通號,a=A(i);a&&(e[s]=a)}),e}function I(t){const e=t.target.files[0];if(!e)return;v.value=e.name;const o=new FileReader;o.onload=s=>{const i=new Uint8Array(s.target.result),a=D(i,{type:"array"}),f=a.SheetNames[0],c=a.Sheets[f];E(c);const p=_.sheet_to_json(c,{defval:""});u.value=p,g.value=B(p)},o.readAsArrayBuffer(e),t.target.value=""}return(t,e)=>{const o=V;return n(),l("section",O,[r("div",M,[r("div",U,[e[4]||(e[4]=r("label",{for:"file-upload",class:"block mb-4 text-xl font-bold text-gray-700 text-center select-none"}," 選擇 Excel 檔案 (.xlsx, .xls) ",-1)),r("input",{ref:"fileInput",id:"file-upload",type:"file",accept:".xlsx,.xls",onChange:I,class:"hidden"},null,544),r("button",{onClick:e[0]||(e[0]=s=>t.$refs.fileInput.click()),class:"w-full py-3 rounded-xl bg-gradient-to-r from-indigo-400 to-purple-500 text-white font-semibold shadow hover:from-purple-500 hover:to-indigo-400 transition-all duration-300"}," 選擇檔案 "),v.value?(n(),l("p",z,[e[3]||(e[3]=y(" 已選擇：")),r("span",L,b(v.value),1)])):h("",!0)]),u.value.length?(n(),l("div",W,[r("div",q,[r("div",G,[m(w($),{class:"w-6 h-6 opacity-80"}),e[5]||(e[5]=r("span",{class:"text-xl font-semibold"},"錯誤欄位總數",-1))]),r("div",H,b(Object.keys(g.value).length),1)])])):h("",!0)]),u.value.length?(n(),l("div",J,[k(m(o,{type:"danger",round:"",onClick:e[1]||(e[1]=s=>d.value=!d.value)},{default:S(()=>e[6]||(e[6]=[y("只顯示錯誤")])),_:1,__:[6]},512),[[C,!d.value]]),k(m(o,{type:"primary",round:"",onClick:e[2]||(e[2]=s=>d.value=!d.value)},{default:S(()=>e[7]||(e[7]=[y("顯示所有")])),_:1,__:[7]},512),[[C,d.value]])])):h("",!0),u.value.length?(n(),l("div",K,[r("table",P,[e[8]||(e[8]=r("thead",{class:"bg-purple-200/50 sticky top-0 text-gray-800 text-sm"},[r("tr",null,[r("th",{class:"border border-white/20 px-4 py-2 text-left"},"#"),r("th",{class:"border border-white/20 px-4 py-2 text-left"},"五通號"),r("th",{class:"border border-white/20 px-4 py-2 text-left"},"錯誤原因")])],-1)),r("tbody",null,[(n(!0),l(F,null,T(w(N),(s,i)=>(n(),l("tr",{key:i,class:"even:bg-white/20 odd:bg-white/10 transition-all hover:bg-white/40"},[r("td",{class:j(["border border-white/20 px-4 py-2 font-black",{"border-red-500 text-red-700 font-black":s.error}])},b(s.displayIndex),3),r("td",{class:j(["border border-white/20 px-4 py-2",{"border-red-500 bg-red-200/30 text-red-700 font-black":s.error}]),title:s.error},b(s.五通號||""),11,Q),s.error?(n(),l("td",X,b(s.error),1)):(n(),l("td",Y))]))),128))])])])):h("",!0)])}}};export{re as default};
